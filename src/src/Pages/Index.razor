@page "/"
@using src.Data
@inject Facade Facade

<PageTitle>Index</PageTitle>

<h1>Escolha a feira</h1>

<input type="text" placeholder="Procurar feira" @bind="@filterValue">

<button @onclick="applyFilter">Procurar</button>

@if (feiras == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <ul>
        @foreach(String feira in filteredFeiras){
            <li><a href="catalogo/@feira">@feira</a></li>
        }
    </ul>
}

@code {
    private List<String>? feiras;
    private List<String>? filteredFeiras;
    private String filterValue;

    protected override async Task OnInitializedAsync()
    {
        feiras = await Facade.getFeiras();
        filteredFeiras = feiras;
    }

    public void applyFilter(){
        filteredFeiras.Clear();
        foreach(String feira in feiras){
            if(feira == filterValue){
                filteredFeiras.Add(feira);
            }
        }
    }
}