@page "/catalogo/{nomeFeira}/{productId}"
@using src.Data.BusinessLogic.SubFeiras
@inject SubFeirasFacade Facade

<style>
    body, html {
        height: 100%;
        width: 100%;
        background-color: white;
    }

    .desc {
        margin: 50px;
        position: absolute;
        z-index: 1;
    }

    .desc p {
        text-align: justify;
        margin-top: 20px;
    }

    .popup {
        margin-top: 0%;
        border: solid;
        text-align: center;
        vertical-align: middle;
        display:  table-cell;
        width: 300px;
        heght: 100px;
        position: absolute;
        top: 0;
        left: 50%;
        transform: translate(-50%, -50%) scale(0.1);
        visibility : hidden;
        transition: transform 0.4s;
    }

    .popup a {
        text-decoration: none;
        color: white;
    }

    .open-popup {
        visibility: visible;
        top: 50%;
        transform: translate(-50%, -50%) scale(1);
        z-index: 10;
        background-color: lightgreen;
    }

    .options {
        display: grid;
        grid-template-columns: 50% 50%;
    }

    .top-bar{
        background-color: darkslateblue;
        border-bottom: solid;
        border-bottom-color: var(--color-primary);
        display: grid;
        grid-template-columns: 30% auto;
        padding: 25px 50px 25px 100px;
        height: 50%;
    }

        .top-bar img {
            float: left;
            border: solid;
            border-width: 3px;
            border-color: grey;
            border-radius: 10%;
        }

        .top-bar .product-content {
            display: grid;
            grid-template-columns: auto auto;
        }

        .top-bar h1 {
            font-weight: bolder;
            font-size: 4em;
            color: white;

        }

        .top-bar .button-ctn {
            display: grid;
            grid-template-columns: 50% 50%;
        }

        .top-bar .product-content .button-submit {
            background-color: darkgoldenrod;
            padding: 4px;
            color: white;
            border-radius: 5px;
            font-size: 2em;
        }

        #heart {
            color: palevioletred;
        }

        #heart:hover {
            color: red;
        }

        .top-bar .product-content .price {
            color: darkgoldenrod;
        }

        .top-bar .product-content .stock{
            color: white;
        }

        .checked {
            color: orange;
        }
        .not-checked{
            color: white;
        }


        .aval-cliente {
            display: flex;
        }

        .first-row {
            display: grid;
            grid-template-columns: auto auto;
            grid-template-rows: auto auto;
            margin-bottom: 35px;
        }

        .first-row p {
            align-self: center;
            justify-self: center;
            font-size: 30px;
        }

        .aval {
            margin-left: 30px;
        }

        .product-content{
            align-self: center;
            justify-self: center;
            display: grid;
            grid-template-columns: auto auto;
            height: 80%;
        }

        .right-content {
            height: 90%;
        }

        .left p {
            text-align: left;
            font-size: 1.5em;
            padding-top: 1em;
            padding-left: 1em;
        }

        .heart-btn{
            display: grid;
            grid-template-columns: 25% 75%;
        }

        .heart-btn i button {
            justify-self: center;
            align-self: center;
        }

        .right {
            padding-top: 30px;
        }

        .stock-preço {
            display: grid;
            grid-template-columns: auto auto;
            padding-top: 10px;
        }

        .stock-preço p {
            align-self: center;
            justify-self: left;
        }

        .bottom-row {
            padding-left: 25%;
            text-align: left;
        }

</style>

<div class="top-bar">
    <img src="css/images/batata-vermelha-final-1.jpg" width="300px" height="300px"/>
    <div class="right-content">
        <h1>@p.nome</h1>
        <div class="product-content">
            <div class="left">
                <p style="color: white;">Categoria: <span style="color: black">@p.categoria</span></p>
                <p style="color: white">Feira: <span style="color: black">@nomeFeira</span></p>
                <p style="color: white">Vendedor: <span style="color: black">@p.nifVendedor</span></p>
                @if(p.fatorAceitacao == -1){
                    <p style="color: red">*Produto indisponível para ser negociado</p>
                }
                else{
                    <p style="color: lawngreen">*Produto disponível para ser negociado</p>
                }
            </div>
            <div class="right">
                <div class="heart-btn">
                    <button style="background-color: darkslateblue"><i id="heart" class="fa fa-heart" style="font-size: 30px; padding: 10px 0 0 30px;"></i></button>
                    <button class="button-submit" @onclick="openPopup">Adicionar ao carrinho</button>
                </div>
                <div class="bottom-row">
                    <div class="stock-preço" style="width: 100%">
                        <p class="stock">Stock: @p.stock</p>
                        <p class="price">Preço: @p.preço€</p>
                    </div>
                    <p style="margin-top: 20px;">Avaliação geral: @p.avaliacaoMedia/5</p>
                    <div class="aval-cliente" style="margin-top: 20px;">
                        <div>
                            <p>Avaliação do cliente: </p>
                        </div>
                        <div class="aval">
                            <span class="fa fa-star checked" style="font-size: 20px"></span>
                            <span class="fa fa-star checked" style="font-size: 20px"></span>
                            <span class="fa fa-star checked" style="font-size: 20px"></span>
                            <span class="fa fa-star not-checked" style="font-size: 20px"></span>
                            <span class="fa fa-star not-checked" style="font-size: 20px"></span>
                        </div>
                    </div>
                </div>
                
            </div>
        </div>
    </div>
</div>

<div class="desc">
    <h2 style="text-align: left">Descrição do produto</h2>
    <p>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec quam felis, malesuada vel elementum id, molestie at odio. Donec at massa sem. Curabitur laoreet ut turpis eget euismod. Proin placerat dictum lorem, id hendrerit dui tristique nec. Duis eget lorem aliquam velit lacinia rhoncus. Suspendisse scelerisque sapien est, eget ultricies libero consequat sit amet. Pellentesque mollis ornare libero id tempor. Sed rutrum dolor eget dolor mattis tincidunt.

        Vestibulum consectetur gravida mattis. Donec venenatis lobortis velit non interdum. Nunc lectus dolor, ultrices sed justo nec, malesuada posuere nisl. Vestibulum venenatis ipsum et felis iaculis fermentum. In et odio quis risus commodo vulputate. Ut id dui vitae tellus aliquet imperdiet quis sed massa. Quisque hendrerit augue vitae dolor aliquam ullamcorper. Proin tempus metus vitae rutrum condimentum.

        Suspendisse mollis orci ac orci dictum, in fringilla risus varius. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Aliquam interdum rutrum justo vel tincidunt. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Phasellus congue mauris non sodales facilisis. Duis hendrerit suscipit mauris non euismod. In nec dolor sit amet neque placerat accumsan. Mauris ut euismod ex. Praesent eu mauris purus. Fusce non scelerisque nisi. Pellentesque vitae mauris id enim tempus bibendum et euismod nibh. Mauris sodales ultricies porta. Curabitur posuere, magna ac sagittis consectetur, velit ex tincidunt dui, sit amet malesuada velit ipsum quis arcu. Vestibulum accumsan bibendum elit a fringilla.

        Duis in est lobortis, commodo neque sit amet, vestibulum libero. Vestibulum ultricies ante et quam viverra, egestas volutpat magna ultrices. Sed imperdiet, mi et egestas ultrices, ipsum nulla suscipit dui, ac consectetur metus enim et nisl. Aliquam placerat finibus laoreet. Donec molestie viverra purus, non commodo est tincidunt at. Pellentesque tempus, est et pharetra finibus, neque diam pulvinar mauris, eget pulvinar nulla lorem et massa. Quisque malesuada congue felis et vestibulum. Morbi tincidunt venenatis erat. Quisque nec nunc at ex pulvinar luctus. Pellentesque vitae congue mauris. Nam rhoncus pharetra diam ac fermentum. Proin ex tortor, dignissim at augue consequat, mattis tincidunt libero. Nam eget augue vel turpis tempus viverra id at risus. Nulla vel lectus sodales, efficitur tellus sed, vulputate est. Phasellus suscipit erat sit amet laoreet suscipit.

        Vestibulum eu malesuada mauris. Praesent a leo id mi tempus aliquam. Fusce fermentum eleifend lorem sit amet laoreet. Proin eleifend justo at gravida facilisis. Mauris fermentum euismod pretium. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Nulla ultricies nibh eget imperdiet posuere. Vivamus ultricies mi velit, quis commodo mi tristique id. Nunc tempus laoreet mattis. Morbi sodales diam vitae velit rhoncus fermentum non vel nisi. Maecenas pulvinar ligula nisi, sed tristique justo rutrum id. Proin ex diam, sollicitudin sed ex rutrum, sollicitudin dictum lacus.
    </p>
</div>

<div class=@popupState>
    <br>
    <h3 style="font:400; font-style:normal ; color: black">Deseja negociar o preço do produto?</h3>
    <br>
    <br>
    <div class="options">
        <p><a href="/Negociacao"> Sim </a></p>
        <p><a href="/catalogo/@nomeFeira/@productId" @onclick="closePopup"> Não </a></p>
    </div>
    <br>
</div>


@code {
    [Parameter]
    public String? nomeFeira { get; set; }
    [Parameter]
    public String productId{ get; set; }
    private Produto p;
    private String popupState = "popup";

    protected override async Task OnInitializedAsync()
    {
        SubFeirasFacade sf = new SubFeirasFacade();
        p = await sf.GetProduto(int.Parse(productId));
    }

    public void OnGet(String productId, String nomeFeira){
        this.productId = productId;
        this.nomeFeira = nomeFeira;
    }

    private void openPopup()
    {
        popupState = "popup open-popup";
    }

    private void closePopup()
    {
        popupState = "popup";
    }
}
